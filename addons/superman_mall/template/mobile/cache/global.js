Number.prototype.formatCurrency=function(places,symbol,thousand,decimal){places=!isNaN(places=Math.abs(places))?places:2;symbol=symbol!==undefined?symbol:'&#165;';thousand=thousand||',';decimal=decimal||'.';var number=this,negative=number<0?'-':'',i=parseInt(number=Math.abs(+number||0).toFixed(places),10)+'',j=(j=i.length)>3?j%3:0;return symbol+negative+(j?i.substr(0,j)+thousand:'')+i.substr(j).replace(/(\d{3})(?=\d)/g,'$1'+thousand)+(places?decimal+Math.abs(number-i).toFixed(places).slice(2):'');};$.extend($,{overlay:{toggle:function(html,click_close){var o=$('.modal-overlay');if(!o.length){var str='<div class="modal-overlay modal-overlay-visible">';str+=typeof html!='undefined'?html:'';str+='</div>';$(document.body).append(str);}else{if(typeof html!='undefined'){o.html(html);}
if(o.css('visibility')=='visible'){o.removeClass('modal-overlay-visible');}else{o.addClass('modal-overlay-visible');}}
if(click_close){o=$('.modal-overlay');o.bind('click',function(){o.removeClass('modal-overlay-visible');});}}},checkLogin:function(targeturl){$.ajax({url:window.sysinfo.check_loginurl,dataType:'json',success:function(resp){$.hideIndicator();if(resp.errno==0){$.router.loadPage(targeturl);}else{$.toast('未登录，跳转中...');setTimeout(function(){window.location.href=window.sysinfo.loginurl;},2000);}}});},timer:{countDownIds:[],run:function(starttime){if(!starttime)return;var nowtime=parseInt(new Date().getTime()/1000);var dd=0,hh=0,mm=0,ss=0;if(starttime>nowtime){var ts=starttime-nowtime;dd=parseInt(ts/60/60/24,10);hh=parseInt(ts/60/60%24,10);mm=parseInt(ts/60%60,10);ss=parseInt(ts%60,10);dd=this.format(dd);hh=this.format(hh);mm=this.format(mm);ss=this.format(ss);}else{this.clear(this.CountDownIds);$.showIndicator();window.location.reload();return false;}
var txt='';if(dd>0){txt+=dd+'天';}
txt+=hh+'时'+mm+'分'+ss+'秒';if(typeof arguments[1]=='string'){$('#'+arguments[1]).html(txt);return true;}else if(typeof arguments[1]=='object'){$(arguments[1]).html(txt);return true;}else{return{day:dd,hour:hh,minute:mm,second:ss};}},format:function(t){return t>=0&&t<10?'0'+t:t;},clear:function(timerId){if($.type(timerId)=='number'){clearInterval(timerId);}else if($.isArray(timerId)){for(var i=0;i<timerId.length;i++){clearInterval(timerId[i]);}
timerId.splice(0,timerId.length);}}},dump:function(arr,level){var dumped_text="";if(!level)level=0;var level_padding="";for(var j=0;j<level+1;j++)level_padding+="    ";if(typeof(arr)=='object'){for(var item in arr){var value=arr[item];if(typeof(value)=='object'){dumped_text+=level_padding+"'"+item+"' ...\n";dumped_text+=$.dump(value,level+1);}else{dumped_text+=level_padding+"'"+item+"' => \""+value+"\"\n";}}}else{dumped_text="===>"+arr+"<===("+typeof(arr)+")";}
return dumped_text;},wxMenu:{show:function(){wx.ready(function(){wx.showOptionMenu();wx.hideMenuItems({menuList:['menuItem:copyUrl','menuItem:favorite','menuItem:share:qq','menuItem:share:weiboApp']});wx.onMenuShareAppMessage(sharedata);wx.onMenuShareTimeline(sharedata);wx.onMenuShareQQ(sharedata);wx.onMenuShareWeibo(sharedata);});},hide:function(){wx.ready(function(){wx.hideOptionMenu();});},hideTimeline:function(){wx.ready(function(){wx.hideMenuItems({menuList:['menuItem:share:timeline']});});}},updateCartCorner:function(page,operator,num){var cart_num=parseInt($('.cart_corner',page).html());if(operator=='+'){cart_num+=num;$('.cart_corner',page).html(cart_num).show();}else if(operator=='-'){cart_num-=num;cart_num=cart_num<0?0:cart_num;if(cart_num==0){$('.cart_corner',page).html(cart_num).hide();}else{$('.cart_corner',page).html(cart_num).show();}}}});$.wxMenu.hide();superman.log=function(msg,type){this.debug=window.sysinfo._debug;switch(type){case'info':console.info(msg);break;case'debug':if(this.debug){console.debug(msg);}
break;case'warn':console.warn(msg);break;case'error':console.error(msg);break;default:console.log(msg);break;}};;$.config={routerFilter:function($link){var href=$($link).attr('href');if($link.hasClass('redirect')&&href!=''){$.toast('跳转中...');return false;}
if($link.hasClass('external')){$.showIndicator();}
if($link.hasClass('check_login')){if(href!=''){$.checkLogin();}}
return true;}};